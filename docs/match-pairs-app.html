<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spanskbert - Matcha par</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #fff;
        }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        .back-btn {
            display: inline-flex; align-items: center; gap: 8px;
            padding: 10px 16px; background: rgba(255,255,255,0.1);
            border: none; border-radius: 10px; color: #888;
            font-size: 0.95rem; cursor: pointer; transition: all 0.2s;
            text-decoration: none; margin-bottom: 20px;
        }
        .back-btn:hover { background: rgba(255,255,255,0.15); color: #fff; }
        header { text-align: center; padding: 20px 0 30px; }
        header h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #2ecc71, #27ae60);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; margin-bottom: 8px;
        }
        header p { color: #888; font-size: 1rem; }
        .stats-overview { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 25px; }
        .stat-card { background: rgba(255,255,255,0.05); border-radius: 15px; padding: 18px 12px; text-align: center; }
        .stat-value { font-size: 1.8rem; font-weight: bold; }
        .stat-value.matches { color: #2ecc71; }
        .stat-value.games { color: #27ae60; }
        .stat-value.best { color: #f39c12; }
        .stat-label { font-size: 0.8rem; color: #888; margin-top: 5px; }
        .main-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 30px; }
        .main-btn {
            padding: 18px 20px; border: none; border-radius: 15px;
            font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s;
        }
        .main-btn.primary { background: linear-gradient(90deg, #2ecc71, #27ae60); color: #fff; }
        .main-btn.secondary { background: rgba(255,255,255,0.1); color: #fff; }
        .main-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.3); }
        .section-title { font-size: 0.85rem; color: #666; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 15px; }
        .categories-list { display: flex; flex-direction: column; gap: 10px; }
        .category-group { margin-bottom: 15px; }
        .category-group-header {
            display: flex; align-items: center; justify-content: space-between;
            padding: 14px 18px; background: rgba(255,255,255,0.08);
            border-radius: 12px; cursor: pointer; transition: all 0.2s; margin-bottom: 8px;
        }
        .category-group-header:hover { background: rgba(255,255,255,0.12); }
        .category-group-title { display: flex; align-items: center; gap: 10px; font-size: 1rem; font-weight: 600; color: #fff; }
        .category-group-title .group-icon { font-size: 1.2rem; }
        .category-group-count { color: #888; font-size: 0.85rem; }
        .category-group-arrow { color: #666; font-size: 1.2rem; transition: transform 0.3s; }
        .category-group.expanded .category-group-arrow { transform: rotate(180deg); }
        .category-group-items { display: none; flex-direction: column; gap: 8px; padding-left: 12px; }
        .category-group.expanded .category-group-items { display: flex; }
        .category-item {
            display: flex; align-items: center; padding: 16px;
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.08);
            border-radius: 15px; cursor: pointer; transition: all 0.2s;
        }
        .category-item:hover { background: rgba(255,255,255,0.08); transform: translateX(5px); }
        .category-icon {
            width: 50px; height: 50px; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; margin-right: 15px; flex-shrink: 0;
        }
        .category-info { flex: 1; }
        .category-name { font-size: 1.1rem; font-weight: 600; margin-bottom: 4px; }
        .category-count { font-size: 0.9rem; color: #888; }
        .progress-circle { width: 45px; height: 45px; }
        .progress-circle svg { transform: rotate(-90deg); }
        .progress-circle .bg { fill: none; stroke: rgba(255,255,255,0.1); stroke-width: 4; }
        .progress-circle .progress { fill: none; stroke: #2ecc71; stroke-width: 4; stroke-linecap: round; }
        .game-view { display: none; }
        .game-view.active { display: block; }
        .category-view { display: block; }
        .category-view.hidden { display: none; }
        .game-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
        .game-title { font-size: 1.3rem; font-weight: 600; }
        .game-timer { color: #3498db; font-size: 1.2rem; font-weight: bold; }
        .stats-bar { display: flex; justify-content: center; gap: 25px; margin-bottom: 20px; }
        .stat { text-align: center; padding: 10px 18px; background: rgba(255,255,255,0.05); border-radius: 12px; }
        .stat .stat-value { font-size: 1.4rem; }
        .stat.matches .stat-value { color: #2ecc71; }
        .stat.attempts .stat-value { color: #f39c12; }
        .game-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .word-column { display: flex; flex-direction: column; gap: 10px; }
        .word-btn {
            padding: 16px; border: 2px solid rgba(255,255,255,0.15);
            border-radius: 12px; background: rgba(255,255,255,0.05);
            color: #fff; font-size: 1rem; cursor: pointer;
            transition: all 0.2s; text-align: center;
        }
        .word-btn:hover:not(.matched):not(.selected) { border-color: rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); }
        .word-btn.selected { border-color: #3498db; background: rgba(52, 152, 219, 0.3); }
        .word-btn.matched { border-color: #2ecc71; background: rgba(46, 204, 113, 0.3); opacity: 0.6; cursor: default; }
        .word-btn.wrong { border-color: #e74c3c; background: rgba(231, 76, 60, 0.3); animation: shake 0.3s; }
        @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-5px)} 75%{transform:translateX(5px)} }
        .results { text-align: center; padding: 40px 20px; background: rgba(255,255,255,0.05); border-radius: 20px; display: none; }
        .results.show { display: block; }
        .results h2 { font-size: 1.8rem; margin-bottom: 20px; }
        .results-stats { display: flex; justify-content: center; gap: 30px; margin: 25px 0; }
        .results-stat { text-align: center; }
        .results-stat-value { font-size: 2.5rem; font-weight: bold; }
        .results-stat-label { color: #888; font-size: 0.9rem; }
        .restart-btn {
            padding: 16px 40px; border: none; border-radius: 15px;
            font-size: 1rem; cursor: pointer;
            background: linear-gradient(90deg, #2ecc71, #27ae60);
            color: #fff; font-weight: 600; margin-top: 15px; transition: all 0.3s;
        }
        .restart-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.3); }
        @media (max-width: 500px) {
            .container { padding: 15px; }
            header h1 { font-size: 2rem; }
            .word-btn { padding: 12px; font-size: 0.9rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="category-view" id="categoryView">
            <a href="index.html" class="back-btn"><span>‚Üê</span> Huvudmeny</a>
            <header>
                <h1>Matcha par</h1>
                <p>Koppla ihop spanska och svenska ord</p>
            </header>
            <div class="stats-overview">
                <div class="stat-card"><div class="stat-value games" id="totalGames">0</div><div class="stat-label">Spel</div></div>
                <div class="stat-card"><div class="stat-value matches" id="totalMatches">0</div><div class="stat-label">Matchade</div></div>
                <div class="stat-card"><div class="stat-value best" id="bestTime">--</div><div class="stat-label">B√§sta tid</div></div>
            </div>
            <div class="main-buttons">
                <button class="main-btn primary" id="practiceAllBtn">Spela nu</button>
                <button class="main-btn secondary" id="randomBtn">Slumpa</button>
            </div>
            <div class="section-title">Kategorier</div>
            <div class="categories-list" id="categoriesList"></div>
        </div>

        <div class="game-view" id="gameView">
            <button class="back-btn" id="backToCategories"><span>‚Üê</span> Tillbaka</button>
            <div class="game-header">
                <div class="game-title" id="gameTitle">Kategori</div>
                <div class="game-timer" id="gameTimer">0:00</div>
            </div>
            <div class="stats-bar">
                <div class="stat matches"><div class="stat-value" id="matchCount">0</div><div class="stat-label">Matchade</div></div>
                <div class="stat attempts"><div class="stat-value" id="attemptCount">0</div><div class="stat-label">F√∂rs√∂k</div></div>
            </div>
            <div class="game-grid" id="gameGrid">
                <div class="word-column" id="spanishColumn"></div>
                <div class="word-column" id="swedishColumn"></div>
            </div>
            <div class="results" id="resultsScreen">
                <h2>Alla matchade!</h2>
                <div class="results-stats">
                    <div class="results-stat"><div class="results-stat-value" id="finalTime" style="color: #3498db;">0:00</div><div class="results-stat-label">Tid</div></div>
                    <div class="results-stat"><div class="results-stat-value" id="finalAttempts" style="color: #f39c12;">0</div><div class="results-stat-label">F√∂rs√∂k</div></div>
                </div>
                <button class="restart-btn" id="restartBtn">Spela igen!</button>
                <br><button class="back-btn" id="backFromResults" style="margin-top: 15px;">‚Üê V√§lj annan kategori</button>
            </div>
        </div>
    </div>

    <script>
        const gameData = {
            "saludos": {
                "name": "H√§lsningar", "icon": "üëã", "color": "#f39c12",
                "items": [
                    {"es": "¬°Hola!", "sv": "Hej!"}, {"es": "Adi√≥s", "sv": "Hejd√•"},
                    {"es": "¬°Buenos d√≠as!", "sv": "God morgon!"}, {"es": "¬°Buenas noches!", "sv": "God kv√§ll!"},
                    {"es": "¬øQu√© tal?", "sv": "Hur √§r det?"}, {"es": "Gracias", "sv": "Tack"}
                ]
            },
            "numeros": {
                "name": "Siffror", "icon": "#", "color": "#3498db",
                "items": [
                    {"es": "uno", "sv": "1"}, {"es": "dos", "sv": "2"}, {"es": "tres", "sv": "3"},
                    {"es": "cuatro", "sv": "4"}, {"es": "cinco", "sv": "5"}, {"es": "diez", "sv": "10"}
                ]
            },
            "familia": {
                "name": "Familjen", "icon": "üë®‚Äçüë©‚Äçüëß", "color": "#9b59b6",
                "items": [
                    {"es": "el padre", "sv": "pappan"}, {"es": "la madre", "sv": "mamman"},
                    {"es": "el hijo", "sv": "sonen"}, {"es": "la hija", "sv": "dottern"},
                    {"es": "el hermano", "sv": "brodern"}, {"es": "la hermana", "sv": "systern"}
                ]
            },
            "colores": {
                "name": "F√§rger", "icon": "üé®", "color": "#2ecc71",
                "items": [
                    {"es": "rojo", "sv": "r√∂d"}, {"es": "azul", "sv": "bl√•"}, {"es": "verde", "sv": "gr√∂n"},
                    {"es": "amarillo", "sv": "gul"}, {"es": "negro", "sv": "svart"}, {"es": "blanco", "sv": "vit"}
                ]
            },
            "dias_semana": {
                "name": "Veckodagar", "icon": "üìÖ", "color": "#1abc9c",
                "items": [
                    {"es": "lunes", "sv": "m√•ndag"}, {"es": "martes", "sv": "tisdag"},
                    {"es": "mi√©rcoles", "sv": "onsdag"}, {"es": "jueves", "sv": "torsdag"},
                    {"es": "viernes", "sv": "fredag"}, {"es": "s√°bado", "sv": "l√∂rdag"}
                ]
            },
            "en_el_medico": {
                "name": "Hos l√§karen", "icon": "üè•", "color": "#e74c3c",
                "items": [
                    {"es": "la cabeza", "sv": "huvudet"}, {"es": "la fiebre", "sv": "feber"},
                    {"es": "la receta", "sv": "recept"}, {"es": "la tos", "sv": "hosta"},
                    {"es": "la alergia", "sv": "allergi"}, {"es": "el m√©dico", "sv": "l√§karen"}
                ]
            },
            "deportes": {
                "name": "Sport", "icon": "‚öΩ", "color": "#2ecc71",
                "items": [
                    {"es": "el f√∫tbol", "sv": "fotboll"}, {"es": "el tenis", "sv": "tennis"},
                    {"es": "correr", "sv": "springa"}, {"es": "el gimnasio", "sv": "gymmet"},
                    {"es": "ganar", "sv": "vinna"}, {"es": "perder", "sv": "f√∂rlora"}
                ]
            },
            "el_tiempo": {
                "name": "V√§der", "icon": "üå§Ô∏è", "color": "#f39c12",
                "items": [
                    {"es": "sol", "sv": "sol"}, {"es": "calor", "sv": "varmt"},
                    {"es": "fr√≠o", "sv": "kallt"}, {"es": "llueve", "sv": "regnar"},
                    {"es": "viento", "sv": "vind"}, {"es": "nublado", "sv": "molnigt"}
                ]
            },
            "comida_y_bebida": {
                "name": "Mat & dryck", "icon": "üçï", "color": "#e67e22",
                "items": [
                    {"es": "el agua", "sv": "vatten"}, {"es": "el pan", "sv": "br√∂d"},
                    {"es": "el pollo", "sv": "kyckling"}, {"es": "el queso", "sv": "ost"},
                    {"es": "el caf√©", "sv": "kaffe"}, {"es": "la leche", "sv": "mj√∂lk"}
                ]
            },
            "en_la_escuela": {
                "name": "I skolan", "icon": "üéì", "color": "#3498db",
                "items": [
                    {"es": "el libro", "sv": "boken"}, {"es": "la clase", "sv": "lektionen"},
                    {"es": "el examen", "sv": "provet"}, {"es": "la pregunta", "sv": "fr√•gan"},
                    {"es": "los deberes", "sv": "l√§xorna"}, {"es": "el profesor", "sv": "l√§raren"}
                ]
            },
            "cuerpo": {
                "name": "Kroppen", "icon": "ü¶¥", "color": "#1abc9c",
                "items": [
                    {"es": "la cabeza", "sv": "huvudet"}, {"es": "el ojo", "sv": "√∂gat"},
                    {"es": "la mano", "sv": "handen"}, {"es": "el pie", "sv": "foten"},
                    {"es": "el brazo", "sv": "armen"}, {"es": "la pierna", "sv": "benet"}
                ]
            },
            "ropa": {
                "name": "Kl√§der", "icon": "üëï", "color": "#e91e63",
                "items": [
                    {"es": "la camiseta", "sv": "t-shirt"}, {"es": "los pantalones", "sv": "byxor"},
                    {"es": "los zapatos", "sv": "skor"}, {"es": "la chaqueta", "sv": "jacka"},
                    {"es": "el vestido", "sv": "kl√§nning"}, {"es": "el sombrero", "sv": "hatt"}
                ]
            },
            "profesiones": {
                "name": "Yrken", "icon": "üë©‚Äçüíº", "color": "#673ab7",
                "items": [
                    {"es": "el m√©dico", "sv": "l√§kare"}, {"es": "el profesor", "sv": "l√§rare"},
                    {"es": "el cocinero", "sv": "kock"}, {"es": "el polic√≠a", "sv": "polis"},
                    {"es": "el bombero", "sv": "brandman"}, {"es": "el ingeniero", "sv": "ingenj√∂r"}
                ]
            },
            "animales": {
                "name": "Djur", "icon": "üêæ", "color": "#795548",
                "items": [
                    {"es": "el perro", "sv": "hund"}, {"es": "el gato", "sv": "katt"},
                    {"es": "el caballo", "sv": "h√§st"}, {"es": "el p√°jaro", "sv": "f√•gel"},
                    {"es": "el le√≥n", "sv": "lejon"}, {"es": "el elefante", "sv": "elefant"}
                ]
            }
        };

        let pairs = [];
        let selectedSpanish = null;
        let selectedSwedish = null;
        let matchCount = 0;
        let attemptCount = 0;
        let timerInterval = null;
        let seconds = 0;
        let currentCategory = null;

        const categoryView = document.getElementById('categoryView');
        const gameView = document.getElementById('gameView');
        const categoriesList = document.getElementById('categoriesList');
        const spanishColumn = document.getElementById('spanishColumn');
        const swedishColumn = document.getElementById('swedishColumn');
        const resultsScreen = document.getElementById('resultsScreen');

        const categoryGroups = {
            "situationer": {
                name: "Situationer",
                icon: "üéØ",
                categories: ["en_el_medico", "deportes", "el_tiempo", "comida_y_bebida", "en_la_escuela"]
            },
            "grundlaggande": {
                name: "Grundl√§ggande",
                icon: "üìö",
                categories: ["saludos", "numeros", "familia", "colores", "dias_semana", "cuerpo", "ropa", "profesiones", "animales"]
            }
        };

        function createCategoryItem(key) {
            const cat = gameData[key];
            const item = document.createElement('div');
            item.className = 'category-item';
            item.innerHTML = `
                <div class="category-icon" style="background: ${cat.color}20; color: ${cat.color};">${cat.icon}</div>
                <div class="category-info"><div class="category-name">${cat.name}</div><div class="category-count">${cat.items.length} par</div></div>
                <div class="progress-circle"><svg width="45" height="45"><circle class="bg" cx="22.5" cy="22.5" r="18"></circle><circle class="progress" cx="22.5" cy="22.5" r="18" stroke-dasharray="113" stroke-dashoffset="113" style="stroke: ${cat.color}"></circle></svg></div>
            `;
            item.addEventListener('click', () => startGame(key));
            return item;
        }

        function initCategories() {
            const saved = JSON.parse(localStorage.getItem('spanishMatchPairs') || '{}');
            const expandedGroups = JSON.parse(localStorage.getItem('spanishMatchPairsExpanded') || '[]');

            Object.keys(categoryGroups).forEach(groupKey => {
                const group = categoryGroups[groupKey];
                const totalItems = group.categories.reduce((sum, catKey) => sum + (gameData[catKey]?.items.length || 0), 0);

                const groupEl = document.createElement('div');
                groupEl.className = 'category-group' + (expandedGroups.includes(groupKey) ? ' expanded' : '');
                groupEl.dataset.group = groupKey;

                const header = document.createElement('div');
                header.className = 'category-group-header';
                header.innerHTML = `
                    <div class="category-group-title"><span class="group-icon">${group.icon}</span>${group.name}</div>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span class="category-group-count">${group.categories.length} kategorier ¬∑ ${totalItems} par</span>
                        <span class="category-group-arrow">‚ñº</span>
                    </div>
                `;
                header.addEventListener('click', () => toggleGroup(groupKey));

                const itemsContainer = document.createElement('div');
                itemsContainer.className = 'category-group-items';

                group.categories.forEach(catKey => {
                    if (gameData[catKey]) {
                        itemsContainer.appendChild(createCategoryItem(catKey));
                    }
                });

                groupEl.appendChild(header);
                groupEl.appendChild(itemsContainer);
                categoriesList.appendChild(groupEl);
            });

            updateOverviewStats();
        }

        function toggleGroup(groupKey) {
            const groupEl = document.querySelector(`.category-group[data-group="${groupKey}"]`);
            groupEl.classList.toggle('expanded');
            const expandedGroups = [];
            document.querySelectorAll('.category-group.expanded').forEach(g => expandedGroups.push(g.dataset.group));
            localStorage.setItem('spanishMatchPairsExpanded', JSON.stringify(expandedGroups));
        }

        function updateOverviewStats() {
            const saved = JSON.parse(localStorage.getItem('spanishMatchPairs') || '{}');
            document.getElementById('totalGames').textContent = saved.sessions || 0;
            document.getElementById('totalMatches').textContent = saved.totalMatches || 0;
            document.getElementById('bestTime').textContent = saved.bestTime ? formatTime(saved.bestTime) : '--';
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function formatTime(s) { return `${Math.floor(s/60)}:${String(s%60).padStart(2,'0')}`; }

        function startGame(category) {
            currentCategory = category;
            pairs = shuffle([...(category === 'all' ? Object.values(gameData).flatMap(c => c.items) : gameData[category].items)]).slice(0, 6);
            matchCount = 0; attemptCount = 0; seconds = 0;
            selectedSpanish = null; selectedSwedish = null;
            document.getElementById('gameTitle').textContent = category === 'all' ? 'Alla' : gameData[category].name;
            categoryView.classList.add('hidden');
            gameView.classList.add('active');
            resultsScreen.classList.remove('show');
            renderGame();
            startTimer();
        }

        function renderGame() {
            spanishColumn.innerHTML = '';
            swedishColumn.innerHTML = '';
            const spanishWords = shuffle(pairs.map((p,i) => ({text: p.es, index: i})));
            const swedishWords = shuffle(pairs.map((p,i) => ({text: p.sv, index: i})));
            spanishWords.forEach(w => {
                const btn = document.createElement('button');
                btn.className = 'word-btn';
                btn.textContent = w.text;
                btn.dataset.index = w.index;
                btn.dataset.lang = 'es';
                btn.addEventListener('click', () => selectWord(btn, 'es'));
                spanishColumn.appendChild(btn);
            });
            swedishWords.forEach(w => {
                const btn = document.createElement('button');
                btn.className = 'word-btn';
                btn.textContent = w.text;
                btn.dataset.index = w.index;
                btn.dataset.lang = 'sv';
                btn.addEventListener('click', () => selectWord(btn, 'sv'));
                swedishColumn.appendChild(btn);
            });
            updateStats();
        }

        function selectWord(btn, lang) {
            if (btn.classList.contains('matched')) return;
            if (lang === 'es') {
                if (selectedSpanish) selectedSpanish.classList.remove('selected');
                selectedSpanish = btn;
                btn.classList.add('selected');
            } else {
                if (selectedSwedish) selectedSwedish.classList.remove('selected');
                selectedSwedish = btn;
                btn.classList.add('selected');
            }
            if (selectedSpanish && selectedSwedish) checkMatch();
        }

        function checkMatch() {
            attemptCount++;
            const esIndex = selectedSpanish.dataset.index;
            const svIndex = selectedSwedish.dataset.index;
            if (esIndex === svIndex) {
                selectedSpanish.classList.add('matched');
                selectedSwedish.classList.add('matched');
                selectedSpanish.classList.remove('selected');
                selectedSwedish.classList.remove('selected');
                matchCount++;
                if (matchCount === pairs.length) { stopTimer(); showResults(); }
            } else {
                selectedSpanish.classList.add('wrong');
                selectedSwedish.classList.add('wrong');
                setTimeout(() => {
                    selectedSpanish.classList.remove('wrong', 'selected');
                    selectedSwedish.classList.remove('wrong', 'selected');
                    selectedSpanish = null; selectedSwedish = null;
                }, 500);
                return;
            }
            selectedSpanish = null; selectedSwedish = null;
            updateStats();
        }

        function updateStats() {
            document.getElementById('matchCount').textContent = matchCount;
            document.getElementById('attemptCount').textContent = attemptCount;
        }

        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                seconds++;
                document.getElementById('gameTimer').textContent = formatTime(seconds);
            }, 1000);
        }

        function stopTimer() { clearInterval(timerInterval); }

        function showResults() {
            document.getElementById('finalTime').textContent = formatTime(seconds);
            document.getElementById('finalAttempts').textContent = attemptCount;
            resultsScreen.classList.add('show');
            saveProgress();
        }

        function saveProgress() {
            const saved = JSON.parse(localStorage.getItem('spanishMatchPairs') || '{}');
            saved.sessions = (saved.sessions || 0) + 1;
            saved.totalMatches = (saved.totalMatches || 0) + matchCount;
            if (!saved.bestTime || seconds < saved.bestTime) saved.bestTime = seconds;
            localStorage.setItem('spanishMatchPairs', JSON.stringify(saved));
        }

        function backToCategories() {
            stopTimer();
            gameView.classList.remove('active');
            categoryView.classList.remove('hidden');
            resultsScreen.classList.remove('show');
            updateOverviewStats();
            categoriesList.innerHTML = '';
            initCategories();
        }

        document.getElementById('practiceAllBtn').addEventListener('click', () => startGame('all'));
        document.getElementById('randomBtn').addEventListener('click', () => startGame('all'));
        document.getElementById('backToCategories').addEventListener('click', backToCategories);
        document.getElementById('backFromResults').addEventListener('click', backToCategories);
        document.getElementById('restartBtn').addEventListener('click', () => { resultsScreen.classList.remove('show'); startGame(currentCategory); });
        initCategories();
    </script>
</body>
</html>
